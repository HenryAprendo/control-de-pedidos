"use strict";(self.webpackChunkcontrol_de_pedidos=self.webpackChunkcontrol_de_pedidos||[]).push([[582],{1582:(H,f,c)=>{c.r(f),c.d(f,{worksRoutes:()=>z});var e=c(5849),m=c(6814),Z=c(5619),h=c(5827);let x=(()=>{class o{constructor(){}saveListWorkOrder(t){localStorage.setItem("listWorkOrder",JSON.stringify(t))}getListWOrkOrder(){const t=localStorage.getItem("listWorkOrder");return null!==t?JSON.parse(t):[]}static#e=this.\u0275fac=function(r){return new(r||o)};static#t=this.\u0275prov=e.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"})}return o})(),p=(()=>{class o{constructor(){this.storeWorkOrder=(0,e.f3M)(x),this.uniqueId=(0,e.f3M)(h.W),this.workOrders=[],this.orderList=new Z.X([]),this.orderList$=this.orderList.asObservable(),this.workOrders=this.storeWorkOrder.getListWOrkOrder()}findOrderList(t){const r=this.workOrders.findIndex(i=>i.workOrderNumber===t);return r>=0?this.workOrders[r]:null}createNewWorkOrder(){let t=this.uniqueId.newWorkOrderId(),i=this.workOrders.push({workOrderNumber:t,createAt:new Date,orderList:[]});return this.storeWorkOrder.saveListWorkOrder(this.workOrders),this.orderList.next(this.workOrders[i-1].orderList),t}addNewOrders(t,r){let i=this.workOrders.findIndex(s=>s.workOrderNumber===t);i>=0&&(this.workOrders[i].orderList.push(r),this.orderList.next(this.workOrders[i].orderList),this.storeWorkOrder.saveListWorkOrder(this.workOrders))}findOrder(t,r){const i=this.workOrders.findIndex(s=>s.workOrderNumber===t);if(i>=0){const s=this.workOrders[i],u=s.orderList.findIndex(l=>l.id===r);if(u>=0)return{...s.orderList[u]}}return null}updateOrder(t,r,i){const s=this.workOrders.findIndex(u=>u.workOrderNumber===t);if(s>=0){const u=this.workOrders[s],l=u.orderList.findIndex(G=>G.id===r);l>=0&&(u.orderList[l]={...i},this.storeWorkOrder.saveListWorkOrder(this.workOrders))}}updateOrderList(t){let r=this.workOrders.findIndex(i=>i.workOrderNumber===t);r>=0&&this.orderList.next(this.workOrders[r].orderList)}static#e=this.\u0275fac=function(r){return new(r||o)};static#t=this.\u0275prov=e.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"})}return o})();var a=c(72);const w=(o,n)=>n.workOrderNumber,T=o=>["orders",o];function k(o,n){if(1&o&&(e.TgZ(0,"li",4),e._uU(1),e.TgZ(2,"span"),e._uU(3),e.ALo(4,"date"),e.qZA()()),2&o){const t=n.$implicit;e.Q6J("routerLink",e.VKq(6,T,t.workOrderNumber)),e.xp6(1),e.hij(" Orden No ",t.workOrderNumber," Fecha "),e.xp6(2),e.Oqu(e.xi3(4,3,t.createAt,"medium"))}}function v(o,n){1&o&&(e.TgZ(0,"p"),e._uU(1,"A\xfan no hay ordenes de trabajos"),e.qZA())}let A=(()=>{class o{constructor(){this.storeWorkOrderService=(0,e.f3M)(x),this.workOrder=(0,e.f3M)(p),this.router=(0,e.f3M)(a.F0),this.listWorkOrder=[]}ngOnInit(){this.listWorkOrder=this.storeWorkOrderService.getListWOrkOrder().reverse()}createOrder(){const t=this.workOrder.createNewWorkOrder();this.router.navigate(["./works/orders",t])}static#e=this.\u0275fac=function(r){return new(r||o)};static#t=this.\u0275cmp=e.Xpm({type:o,selectors:[["app-home-work"]],standalone:!0,features:[e.jDz],decls:9,vars:1,consts:[[1,"flex"],[1,"w-1/6","h-20","border-r-2","border-r-slate-200"],["type","button",1,"px-3","py-1","border","border-b-2","border-indigo-500","text-indigo-600",3,"click"],[1,"w-5/6","px-3"],[3,"routerLink"]],template:function(r,i){1&r&&(e.TgZ(0,"div",0)(1,"div",1)(2,"button",2),e.NdJ("click",function(){return i.createOrder()}),e._uU(3,"Nueva orden de trabajo"),e.qZA()(),e.TgZ(4,"div",3)(5,"ul"),e.SjG(6,k,5,8,"li",4,w,!1,v,2,0),e.qZA()()()),2&r&&(e.xp6(6),e.wJu(i.listWorkOrder))},dependencies:[m.ez,m.uU,a.Bz,a.rH]})}return o})(),q=(()=>{class o{constructor(){}static#e=this.\u0275fac=function(r){return new(r||o)};static#t=this.\u0275cmp=e.Xpm({type:o,selectors:[["app-orders"]],standalone:!0,features:[e.jDz],decls:14,vars:0,consts:[[1,"text-lg","font-medium"],[1,"flex"],[1,"w-1/6"],[1,"pt-4","text-sm"],[1,"space-y-5"],["routerLink","./",1,"border","p-1"],["routerLink","./new-orders","routerLinkActive","border-dashed border-pink-500 font-semibold",1,"border","p-1"],[1,"w-5/6"]],template:function(r,i){1&r&&(e.TgZ(0,"h2",0),e._uU(1,"Gesti\xf3n de pedidos"),e.qZA(),e.TgZ(2,"div",1)(3,"section",2)(4,"nav",3)(5,"ul",4)(6,"li")(7,"a",5),e._uU(8,"listado"),e.qZA()(),e.TgZ(9,"li")(10,"a",6),e._uU(11,"Nuevo pedido"),e.qZA()()()()(),e.TgZ(12,"section",7),e._UZ(13,"router-outlet"),e.qZA()())},dependencies:[a.Bz,a.lC,a.rH,a.Od]})}return o})();const g=(o,n)=>n.id;function C(o,n){if(1&o&&(e.TgZ(0,"ul",12)(1,"li",2),e._uU(2),e.qZA(),e.TgZ(3,"li"),e._uU(4,"Cantidad: "),e.TgZ(5,"span",6),e._uU(6),e.qZA()(),e.TgZ(7,"li"),e._uU(8,"Subtotal: "),e.TgZ(9,"span",6),e._uU(10),e.qZA()()()),2&o){const t=n.$implicit;e.xp6(2),e.Oqu(t.name),e.xp6(4),e.Oqu(t.amount),e.xp6(4),e.hij("$",t.amount*t.price,"")}}const L=o=>["./edit-order",o];function U(o,n){if(1&o&&(e.TgZ(0,"div",3)(1,"ul",4)(2,"li",5),e._uU(3,"Pedido N\xb0: "),e.TgZ(4,"span",6),e._uU(5),e.qZA()(),e.TgZ(6,"li",5),e._uU(7,"Torre: "),e.TgZ(8,"span",6),e._uU(9),e.qZA()(),e.TgZ(10,"li",5),e._uU(11,"Apto: "),e.TgZ(12,"span",6),e._uU(13),e.qZA()(),e.TgZ(14,"li",7)(15,"a",8),e._uU(16,"Editar"),e.qZA()()(),e.TgZ(17,"div",9),e.SjG(18,C,11,3,"ul",13,g),e.qZA(),e.TgZ(20,"div",10)(21,"p",11),e._uU(22,"Total a pagar: $"),e.TgZ(23,"span"),e._uU(24),e.qZA()()()()),2&o){const t=n.$implicit,r=n.$index,i=e.oxw();e.xp6(5),e.Oqu(r+1),e.xp6(4),e.Oqu(t.tower),e.xp6(4),e.Oqu(t.apartment),e.xp6(2),e.Q6J("routerLink",e.VKq(5,L,t.id)),e.xp6(3),e.wJu(t.listOrders),e.xp6(6),e.Oqu(i.calculateTotalPerOrder(t.listOrders))}}let N=(()=>{class o{constructor(){this.route=(0,e.f3M)(a.gz),this.workOrderService=(0,e.f3M)(p),this.total=0}ngOnInit(){this.route.parent?.paramMap.subscribe(r=>this.orderNumber=Number(r.get("orderNumber")));const t=this.workOrderService.findOrderList(this.orderNumber);null!==t&&(this.ordersProduct=[...t.orderList],this.orders={...t},this.total=this.calculateTotalProduction())}calculateTotalPerOrder(t){return t.map(i=>i.amount*i.price).reduce((i,s)=>i+s)}calculateTotalProduction(){return this.ordersProduct.flatMap(s=>s.listOrders).map(s=>s.amount*s.price).reduce((s,u)=>s+u)}static#e=this.\u0275fac=function(r){return new(r||o)};static#t=this.\u0275cmp=e.Xpm({type:o,selectors:[["app-list-orders"]],standalone:!0,features:[e.jDz],decls:13,vars:5,consts:[[1,"mb-8","space-y-2"],[1,"text-xl","font-medium"],[1,"font-medium"],[1,"border","mb-8","bg-neutral-50"],[1,"flex","items-center","border-b","text-indigo-500"],[1,"border-r","px-2"],[1,"text-stone-800"],[1,"p-2","justify-items-end"],[1,"border","p-1",3,"routerLink"],[1,"grid","grid-cols-4"],[1,"border-t"],[1,"px-2","text-pink-500"],[1,"p-2","border-r","border-b","text-teal-700"],["class","p-2 border-r border-b text-teal-700"],["class","border mb-8 bg-neutral-50"]],template:function(r,i){1&r&&(e.TgZ(0,"div",0)(1,"h2",1),e._uU(2,"Listado de pedidos realizados"),e.qZA(),e.TgZ(3,"p",2),e._uU(4),e.qZA()(),e.TgZ(5,"div"),e.SjG(6,U,25,7,"div",14,g),e.qZA(),e.TgZ(8,"p"),e._uU(9,"Total de la cuenta: "),e.TgZ(10,"span"),e._uU(11),e.ALo(12,"currency"),e.qZA()()),2&r&&(e.xp6(4),e.hij("Orden de trabajo N\xb0 ",i.orders.workOrderNumber,""),e.xp6(2),e.wJu(i.ordersProduct),e.xp6(5),e.Oqu(e.xi3(12,2,i.total,"COP")))},dependencies:[m.ez,m.H9,a.Bz,a.rH]})}return o})();var d=c(95),O=c(547);const b=[1,2,3,4,5,6,7,8,9,10,11,12,13,14],_=[101,102,103,104,201,202,203,204,301,302,303,304,401,402,403,404,501,502,503,504,601,602,603,604,701,702,703,704,801,802,803,804,901,902,903,904,1001,1002,1003,1004,1101,1102,1103,1104,1201,1202,1203,1204],P=(o,n)=>n.id;function F(o,n){if(1&o&&(e.TgZ(0,"option",11),e._uU(1),e.qZA()),2&o){const t=n.$implicit;e.Q6J("value",t),e.xp6(1),e.Oqu(t)}}function y(o,n){if(1&o&&(e.TgZ(0,"option",11),e._uU(1),e.qZA()),2&o){const t=n.$implicit;e.Q6J("value",t),e.xp6(1),e.Oqu(t)}}function S(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"article",12)(1,"section",13)(2,"div",14)(3,"h3",15),e._uU(4),e.qZA(),e.TgZ(5,"p",16),e._uU(6),e.ALo(7,"currency"),e.qZA()(),e.TgZ(8,"div")(9,"figure"),e._UZ(10,"img",17),e.qZA()()(),e.TgZ(11,"section",18)(12,"p",19),e._uU(13),e.qZA(),e.TgZ(14,"div",20)(15,"button",21),e.NdJ("click",function(){const s=e.CHM(t).$implicit,u=e.oxw();return e.KtG(u.incrementAmountProduct(s.id))}),e._uU(16,"+"),e.qZA(),e.TgZ(17,"button",21),e.NdJ("click",function(){const s=e.CHM(t).$implicit,u=e.oxw();return e.KtG(u.decrementAmountProduct(s.id))}),e._uU(18,"-"),e.qZA()()()()}if(2&o){const t=n.$implicit;e.xp6(4),e.Oqu(t.name),e.xp6(2),e.Oqu(e.xi3(7,5,t.price,"COP")),e.xp6(4),e.Q6J("src",t.image,e.LSH)("alt",t.name),e.xp6(3),e.Oqu(t.amount)}}let J=(()=>{class o{constructor(){this.numTowers=b.slice(),this.numApartments=_.slice(),this.workOrderService=(0,e.f3M)(p),this.uniqueId=(0,e.f3M)(h.W),this.fb=(0,e.f3M)(d.qu),this.route=(0,e.f3M)(a.gz),this.menuService=(0,e.f3M)(O.h),this.menuProducts=[],this.numberOrder=(0,e.tdS)(0),this.readNumOrder=(0,e.Flj)(()=>this.numberOrder()),this.orderProducts=[],this.buildForm()}ngOnInit(){this.route.parent?.paramMap.subscribe(t=>{this.numberOrder.set(Number(t.get("orderNumber")))}),this.menuProducts=this.menuService.retrieve()}buildForm(){this.formLocations=this.fb.group({tower:[1,[d.kI.required]],apartment:[101,[d.kI.required]]})}saveOrders(){if(this.formLocations.valid){const t=this.menuProducts.filter(i=>i.amount>0);let r={id:this.uniqueId.newOrderId(),tower:this.towerField?.value,apartment:this.apartmentField?.value,listOrders:[...t]};this.workOrderService.addNewOrders(this.readNumOrder(),r)}}get towerField(){return this.formLocations.get("tower")}get apartmentField(){return this.formLocations.get("apartment")}incrementAmountProduct(t){const r=this.menuProducts.findIndex(i=>i.id===t);r>=0&&(this.menuProducts[r].amount+=1)}decrementAmountProduct(t){const r=this.menuProducts.findIndex(i=>i.id===t);r>=0&&(this.menuProducts[r].amount>0?this.menuProducts[r].amount-=1:this.menuProducts[r].amount=0)}static#e=this.\u0275fac=function(r){return new(r||o)};static#t=this.\u0275cmp=e.Xpm({type:o,selectors:[["app-create-orders"]],standalone:!0,features:[e.jDz],decls:25,vars:1,consts:[[1,"flex","gap-x-10"],[3,"formGroup","ngSubmit"],[1,"font-medium","mb-4"],[1,"flex","gap-x-6","mb-8"],[1,"flex","flex-col"],["for","tower-id",1,"text-sm","font-semibold"],["name","tower","id","tower-id","formControlName","tower",1,"border","p-2"],["for","apartment-id",1,"text-sm","font-semibold"],["name","apartment","id","apartment-id","formControlName","apartment",1,"border","p-2"],["type","submit",1,"px-3","py-1","border","border-b-2","border-indigo-500","text-indigo-600"],[1,"grid","grid-cols-2","gap-5"],[3,"value"],[1,"rounded-full","border","w-96","h-24","p-3","flex","justify-around","gap-x-4","shadow-md"],[1,"flex","gap-x-3","items-center"],[1,"flex","flex-col","justify-center","items-center"],[1,"text-base","text-blue-600"],[1,"text-sm","font-light","text-slate-950"],[1,"w-14","h-14",3,"src","alt"],[1,"flex","flex-col","items-center","justify-center"],[1,"mb-2","text-xl"],[1,"flex","gap-x-7"],[1,"w-8","h-8","flex","items-center","justify-center","border","rounded-full","text-white","bg-slate-700","hover:bg-slate-800","active:bg-slate-900","hover:scale-105",3,"click"],["class","rounded-full border w-96 h-24 p-3 flex justify-around gap-x-4 shadow-md"]],template:function(r,i){1&r&&(e.TgZ(0,"div",0)(1,"form",1),e.NdJ("ngSubmit",function(){return i.saveOrders()}),e.TgZ(2,"h2",2),e._uU(3,"Selecciona la ubicaci\xf3n"),e.qZA(),e.TgZ(4,"div",3)(5,"div",4)(6,"label",5),e._uU(7,"No de Torre"),e.qZA(),e.TgZ(8,"select",6),e.SjG(9,F,2,2,"option",11,e.ikw),e.qZA()(),e.TgZ(11,"div",4)(12,"label",7),e._uU(13,"No Apartamento"),e.qZA(),e.TgZ(14,"select",8),e.SjG(15,y,2,2,"option",11,e.ikw),e.qZA()()(),e.TgZ(17,"button",9),e._uU(18,"Guardar"),e.qZA()(),e.TgZ(19,"div")(20,"h2",2),e._uU(21,"Agrega productos a tu pedido"),e.qZA(),e.TgZ(22,"div",10),e.SjG(23,S,19,8,"article",22,P),e.qZA()()()),2&r&&(e.xp6(1),e.Q6J("formGroup",i.formLocations),e.xp6(8),e.wJu(i.numTowers),e.xp6(6),e.wJu(i.numApartments),e.xp6(8),e.wJu(i.menuProducts))},dependencies:[m.ez,m.H9,d.UX,d._Y,d.YN,d.Kr,d.EJ,d.JJ,d.JL,d.sg,d.u]})}return o})();var j=c(4664),W=c(2096);const M=(o,n)=>n.id;function I(o,n){if(1&o&&(e.TgZ(0,"option",12),e._uU(1),e.qZA()),2&o){const t=n.$implicit;e.Q6J("value",t),e.xp6(1),e.Oqu(t)}}function E(o,n){if(1&o&&(e.TgZ(0,"option",12),e._uU(1),e.qZA()),2&o){const t=n.$implicit;e.Q6J("value",t),e.xp6(1),e.Oqu(t)}}function $(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"article",13)(1,"section",14)(2,"div",15)(3,"h3",16),e._uU(4),e.qZA(),e.TgZ(5,"p",17),e._uU(6),e.ALo(7,"currency"),e.qZA()(),e.TgZ(8,"div")(9,"figure"),e._UZ(10,"img",18),e.qZA()()(),e.TgZ(11,"section",19)(12,"p",20),e._uU(13),e.qZA(),e.TgZ(14,"div",21)(15,"button",22),e.NdJ("click",function(){const s=e.CHM(t).$implicit,u=e.oxw();return e.KtG(u.incrementAmountProduct(s.id))}),e._uU(16,"+"),e.qZA(),e.TgZ(17,"button",22),e.NdJ("click",function(){const s=e.CHM(t).$implicit,u=e.oxw();return e.KtG(u.decrementAmountProduct(s.id))}),e._uU(18,"-"),e.qZA()()()()}if(2&o){const t=n.$implicit;e.xp6(4),e.Oqu(t.name),e.xp6(2),e.Oqu(e.xi3(7,5,t.price,"COP")),e.xp6(4),e.Q6J("src",t.image,e.LSH)("alt",t.name),e.xp6(3),e.Oqu(t.amount)}}const z=[{path:"",component:A},{path:"orders/:orderNumber",component:q,children:[{path:"",component:N},{path:"new-orders",component:J},{path:"edit-order/:id",component:(()=>{class o{constructor(){this.numTowers=b.slice(),this.numApartments=_.slice(),this.route=(0,e.f3M)(a.gz),this.router=(0,e.f3M)(a.F0),this.workOrderService=(0,e.f3M)(p),this.fb=(0,e.f3M)(d.qu),this.menuService=(0,e.f3M)(O.h),this.menuProducts=[],this.buildForm()}ngOnInit(){this.route.parent?.paramMap.subscribe(t=>this.ordersNumber=Number(t.get("orderNumber"))),this.route.paramMap.pipe((0,j.w)(t=>{let r=Number(t.get("id"));return(0,W.of)(this.workOrderService.findOrder(this.ordersNumber,r))})).subscribe(t=>{t&&(this.product=t,this.formEditLocations.setValue({tower:t.tower,apartment:t.apartment}),this.menuProducts=this.updateMenuProducts(this.menuService.retrieve(),t.listOrders))})}editOrder(){if(this.formEditLocations.valid){const t=this.menuProducts.filter(i=>i.amount>0);let r={id:this.product.id,tower:this.towerField?.value,apartment:this.apartmentField?.value,listOrders:[...t]};this.workOrderService.updateOrder(this.ordersNumber,this.product.id,r),this.router.navigate(["works/orders",this.ordersNumber])}else this.formEditLocations.markAllAsTouched()}buildForm(){this.formEditLocations=this.fb.group({tower:[1,[d.kI.required]],apartment:[101,[d.kI.required]]})}get towerField(){return this.formEditLocations.get("tower")}get apartmentField(){return this.formEditLocations.get("apartment")}incrementAmountProduct(t){const r=this.menuProducts.findIndex(i=>i.id===t);r>=0&&(this.menuProducts[r].amount+=1)}decrementAmountProduct(t){const r=this.menuProducts.findIndex(i=>i.id===t);r>=0&&(this.menuProducts[r].amount>0?this.menuProducts[r].amount-=1:this.menuProducts[r].amount=0)}updateMenuProducts(t,r){let i=[];return t.forEach(s=>{let u=r.find(l=>l.id===s.id);i.push(void 0!==u?{...u}:{...s})}),i}static#e=this.\u0275fac=function(r){return new(r||o)};static#t=this.\u0275cmp=e.Xpm({type:o,selectors:[["app-edit-order"]],standalone:!0,features:[e.jDz],decls:27,vars:1,consts:[[1,"text-xl","font-medium","mb-5"],[1,"flex","gap-x-10"],[3,"formGroup","ngSubmit"],[1,"font-medium","mb-4"],[1,"flex","gap-x-6","mb-8"],[1,"flex","flex-col"],["for","tower-id",1,"text-sm","font-semibold"],["name","tower","id","tower-id","formControlName","tower",1,"border","p-2"],["for","apartment-id",1,"text-sm","font-semibold"],["name","apartment","id","apartment-id","formControlName","apartment",1,"border","p-2"],["type","submit",1,"px-3","py-1","border","border-b-2","border-indigo-500","text-indigo-600"],[1,"grid","grid-cols-2","gap-5"],[3,"value"],[1,"rounded-full","border","w-96","h-24","p-3","flex","justify-around","gap-x-4","shadow-md"],[1,"flex","gap-x-3","items-center"],[1,"flex","flex-col","justify-center","items-center"],[1,"text-base","text-blue-600"],[1,"text-sm","font-light","text-slate-950"],[1,"w-14","h-14",3,"src","alt"],[1,"flex","flex-col","items-center","justify-center"],[1,"mb-2","text-xl"],[1,"flex","gap-x-7"],[1,"w-8","h-8","flex","items-center","justify-center","border","rounded-full","text-white","bg-slate-700","hover:bg-slate-800","active:bg-slate-900","hover:scale-105",3,"click"],["class","rounded-full border w-96 h-24 p-3 flex justify-around gap-x-4 shadow-md"]],template:function(r,i){1&r&&(e.TgZ(0,"h2",0),e._uU(1,"Pagina de editar pedidos"),e.qZA(),e.TgZ(2,"div",1)(3,"form",2),e.NdJ("ngSubmit",function(){return i.editOrder()}),e.TgZ(4,"h2",3),e._uU(5,"Selecciona la ubicaci\xf3n"),e.qZA(),e.TgZ(6,"div",4)(7,"div",5)(8,"label",6),e._uU(9,"No de Torre"),e.qZA(),e.TgZ(10,"select",7),e.SjG(11,I,2,2,"option",12,e.ikw),e.qZA()(),e.TgZ(13,"div",5)(14,"label",8),e._uU(15,"No Apartamento"),e.qZA(),e.TgZ(16,"select",9),e.SjG(17,E,2,2,"option",12,e.ikw),e.qZA()()(),e.TgZ(19,"button",10),e._uU(20,"Actualizar"),e.qZA()(),e.TgZ(21,"div")(22,"h2",3),e._uU(23,"Agrega productos a tu pedido"),e.qZA(),e.TgZ(24,"div",11),e.SjG(25,$,19,8,"article",23,M),e.qZA()()()),2&r&&(e.xp6(3),e.Q6J("formGroup",i.formEditLocations),e.xp6(8),e.wJu(i.numTowers),e.xp6(6),e.wJu(i.numApartments),e.xp6(8),e.wJu(i.menuProducts))},dependencies:[m.ez,m.H9,d.UX,d._Y,d.YN,d.Kr,d.EJ,d.JJ,d.JL,d.sg,d.u]})}return o})()}]}]}}]);